
/**********************************************************************************************************************
 *  INCLUDES
 *********************************************************************************************************************/
#include <stdio.h>
#include <stdarg.h>

#include "logger.h"
#include "stdmalloc.h"

/**********************************************************************************************************************
 *  MACRO
 *********************************************************************************************************************/

/**********************************************************************************************************************
 * GLOBAL VARIABLES
 *********************************************************************************************************************/

/**********************************************************************************************************************
 * LOCAL FUNCTION DECLARATION
 *********************************************************************************************************************/
static void log_malloc(heap_t *heap);

/**********************************************************************************************************************
 * LOCAL FUNCTION DEFINITION
 *********************************************************************************************************************/
static void log_malloc(heap_t *head)
{
    size_t heap_cnt = 0;
    size_t block_cnt = 0;

    printf("##########################################\n\n");
    for (heap_t *it_heap = head; it_heap != NULL; it_heap = it_heap->next)
    {
        printf("* --------------------------\n");
        printf("* HEAP NO       : %d\n", ++heap_cnt);
        printf("* TOTAL CAPACITY: %d\n", it_heap->total_capacity);
        printf("* FREE SPACE    : %d\n", it_heap->remaining_space);
        printf("* NUM OF BLOCKS : %d\n\n", it_heap->block_count);

        block_cnt = 0;
        for (block_t *it_block = SHIFT_POINTER(it_heap, HEAP_HEADER); it_block != NULL; it_block = it_block->next)
        {
            printf("# BLOCK NO    : %d\n", ++block_cnt);
            printf("# BLOCK SIZE  : %ld\n", it_block->data_size);
            printf("# BLOCK STATUS: %s\n\n", it_block->block_status == FREE ? "BLOCK_FREE" : "BLOCK_OCCUPIED");
        }
        printf("* --------------------------\n\n");
    }
    printf("##########################################\n\n\n");
}

/**********************************************************************************************************************
 * GLOBAL FUNCTION DEFINITION
 *********************************************************************************************************************/
void log(component_t component, ...)
{
    va_list args_ptr;

    if (MALLOC == component)
    {
        va_start(args_ptr, 1);
        log_malloc(va_arg(args_ptr, heap_t *));
    }
    else
    {
        /* NOTHING TO BE DONE */
    }
}